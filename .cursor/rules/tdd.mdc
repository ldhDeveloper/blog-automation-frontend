---
description: TDD(Test-Driven Development) ê°œë°œ ë°©ë²•ë¡  ë° í…ŒìŠ¤íŠ¸ ìš°ì„  ê°œë°œ ê·œì¹™
globs: **/*.{ts,tsx,js,jsx}
alwaysApply: true
---

# TDD (Test-Driven Development) ê·œì¹™

## ğŸ”´ Red-Green-Refactor ì‚¬ì´í´

ëª¨ë“  ì½”ë“œ ì‘ì„±ì€ ë‹¤ìŒ TDD ì‚¬ì´í´ì„ ì—„ê²©íˆ ì¤€ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤:

### 1. ğŸ”´ Red (ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì‘ì„±)
```typescript
// âœ… DO: ë¨¼ì € ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±
describe('UserService', () => {
  it('should create a new user with valid data', async () => {
    // Given
    const userData = {
      email: 'test@example.com',
      name: 'Test User',
    };

    // When
    const result = await userService.createUser(userData);

    // Then
    expect(result).toMatchObject({
      id: expect.any(String),
      email: 'test@example.com',
      name: 'Test User',
    });
  });
});

// âŒ DON'T: í…ŒìŠ¤íŠ¸ ì—†ì´ ì½”ë“œë¶€í„° ì‘ì„±
export class UserService {
  async createUser(data: CreateUserDto) {
    // êµ¬í˜„...
  }
}
```

### 2. ğŸŸ¢ Green (ìµœì†Œí•œì˜ ì½”ë“œë¡œ í…ŒìŠ¤íŠ¸ í†µê³¼)
```typescript
// âœ… DO: í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ëŠ” ìµœì†Œí•œì˜ ì½”ë“œ
export class UserService {
  async createUser(data: CreateUserDto): Promise<User> {
    return {
      id: '1',
      email: data.email,
      name: data.name,
      createdAt: new Date().toISOString(),
    };
  }
}
```

### 3. ğŸ”µ Refactor (ì½”ë“œ ê°œì„ )
```typescript
// âœ… DO: í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•œ í›„ ë¦¬íŒ©í† ë§
export class UserService {
  constructor(private userRepository: UserRepository) {}

  async createUser(data: CreateUserDto): Promise<User> {
    const user = new User({
      id: generateId(),
      email: data.email,
      name: data.name,
      createdAt: new Date(),
    });
    
    return await this.userRepository.save(user);
  }
}
```

## ğŸ“‹ í…ŒìŠ¤íŠ¸ ì‘ì„± ê·œì¹™

### Given-When-Then íŒ¨í„´ ì‚¬ìš©
```typescript
// âœ… DO: ëª…í™•í•œ Given-When-Then êµ¬ì¡°
describe('PostService', () => {
  it('should publish a post when status is ready', async () => {
    // Given - í…ŒìŠ¤íŠ¸ ì¡°ê±´ ì„¤ì •
    const post = createMockPost({ status: 'ready' });
    const mockPublishService = vi.fn().mockResolvedValue(true);
    
    // When - í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì‹¤í–‰
    const result = await postService.publish(post.id);
    
    // Then - ê²°ê³¼ ê²€ì¦
    expect(result.status).toBe('published');
    expect(mockPublishService).toHaveBeenCalledWith(post.id);
  });
});
```

### í…ŒìŠ¤íŠ¸ ë„¤ì´ë° ê·œì¹™
```typescript
// âœ… DO: ëª…í™•í•˜ê³  ì„¤ëª…ì ì¸ í…ŒìŠ¤íŠ¸ ì´ë¦„
describe('Authentication', () => {
  describe('login', () => {
    it('should return user data when credentials are valid', () => {});
    it('should throw error when email is invalid', () => {});
    it('should throw error when password is incorrect', () => {});
  });
});

// âŒ DON'T: ëª¨í˜¸í•œ í…ŒìŠ¤íŠ¸ ì´ë¦„
describe('test', () => {
  it('works', () => {});
  it('fails', () => {});
});
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ìœ í˜•ë³„ ê·œì¹™

### Unit Tests (ë‹¨ìœ„ í…ŒìŠ¤íŠ¸)
```typescript
// âœ… DO: ë‹¨ì¼ í•¨ìˆ˜/í´ë˜ìŠ¤ì˜ ë™ì‘ í…ŒìŠ¤íŠ¸
describe('validateEmail', () => {
  it('should return true for valid email format', () => {
    expect(validateEmail('test@example.com')).toBe(true);
  });
  
  it('should return false for invalid email format', () => {
    expect(validateEmail('invalid-email')).toBe(false);
  });
});
```

### Integration Tests (í†µí•© í…ŒìŠ¤íŠ¸)
```typescript
// âœ… DO: ì—¬ëŸ¬ ëª¨ë“ˆ ê°„ì˜ ìƒí˜¸ì‘ìš© í…ŒìŠ¤íŠ¸
describe('PostCreationFlow', () => {
  it('should create post and send notification', async () => {
    // Given
    const postData = { title: 'Test', content: 'Content' };
    
    // When
    const post = await postService.create(postData);
    
    // Then
    expect(post).toBeDefined();
    expect(notificationService.sendCreatedNotification).toHaveBeenCalled();
  });
});
```

### Component Tests (ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸)
```typescript
// âœ… DO: React ì»´í¬ë„ŒíŠ¸ ë™ì‘ í…ŒìŠ¤íŠ¸
describe('LoginForm', () => {
  it('should call onSubmit with form data when submitted', async () => {
    // Given
    const mockOnSubmit = vi.fn();
    render(<LoginForm onSubmit={mockOnSubmit} />);
    
    // When
    await userEvent.type(screen.getByLabelText(/email/i), 'test@example.com');
    await userEvent.type(screen.getByLabelText(/password/i), 'password123');
    await userEvent.click(screen.getByRole('button', { name: /login/i }));
    
    // Then
    expect(mockOnSubmit).toHaveBeenCalledWith({
      email: 'test@example.com',
      password: 'password123',
    });
  });
});
```

## ğŸ¯ TDD ëª¨ë²” ì‚¬ë¡€

### 1. í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € ì‘ì„±í•˜ê³  ì‹¤í–‰í•˜ì—¬ ì‹¤íŒ¨ í™•ì¸
```bash
# âœ… DO: í…ŒìŠ¤íŠ¸ ì‹¤í–‰ìœ¼ë¡œ Red ìƒíƒœ í™•ì¸
npm test -- --watch
```

### 2. ìµœì†Œí•œì˜ ì½”ë“œë¡œ í…ŒìŠ¤íŠ¸ í†µê³¼
```typescript
// âœ… DO: í•˜ë“œì½”ë”©ì´ë¼ë„ í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € í†µê³¼ì‹œí‚¤ê¸°
function add(a: number, b: number): number {
  return 4; // í…ŒìŠ¤íŠ¸ì—ì„œ add(2, 2) === 4ë¥¼ ê²€ì¦í•œë‹¤ë©´
}

// ì´í›„ ë” ë§ì€ í…ŒìŠ¤íŠ¸ ì¶”ê°€í•˜ë©° ì¼ë°˜í™”
```

### 3. í•œ ë²ˆì— í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ë§Œ ì‘ì„±
```typescript
// âœ… DO: í•˜ë‚˜ì”© ì°¨ê·¼ì°¨ê·¼
it('should validate required fields', () => {
  // ì´ í…ŒìŠ¤íŠ¸ë§Œ í†µê³¼ì‹œí‚¤ê¸° ìœ„í•œ ì½”ë“œ ì‘ì„±
});

// ë‹¤ìŒ í…ŒìŠ¤íŠ¸ëŠ” ìœ„ í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•œ í›„ì— ì‘ì„±
it('should validate email format', () => {
  // ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸
});
```

## ğŸ”§ Mock ë° Stub ì‚¬ìš© ê·œì¹™

### ì™¸ë¶€ ì˜ì¡´ì„± Mocking
```typescript
// âœ… DO: ì™¸ë¶€ ì˜ì¡´ì„±ì„ Mockìœ¼ë¡œ ê²©ë¦¬
describe('UserService', () => {
  beforeEach(() => {
    vi.clearAllMocks();
  });

  it('should save user to database', async () => {
    // Given
    const mockSave = vi.fn().mockResolvedValue({ id: '1' });
    const userRepository = { save: mockSave };
    const userService = new UserService(userRepository);
    
    // When
    await userService.createUser({ email: 'test@example.com' });
    
    // Then
    expect(mockSave).toHaveBeenCalledWith(
      expect.objectContaining({ email: 'test@example.com' })
    );
  });
});
```

### API í˜¸ì¶œ Mocking
```typescript
// âœ… DO: API í˜¸ì¶œì„ Mockìœ¼ë¡œ í…ŒìŠ¤íŠ¸
describe('fetchUserData', () => {
  it('should return user data on successful API call', async () => {
    // Given
    const mockUser = { id: '1', name: 'Test User' };
    global.fetch = vi.fn().mockResolvedValue({
      ok: true,
      json: vi.fn().mockResolvedValue(mockUser),
    });
    
    // When
    const result = await fetchUserData('1');
    
    // Then
    expect(result).toEqual(mockUser);
    expect(fetch).toHaveBeenCalledWith('/api/users/1');
  });
});
```

## ğŸ“Š í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ê·œì¹™

### ì»¤ë²„ë¦¬ì§€ ëª©í‘œ
- **Unit Tests**: 90% ì´ìƒ
- **Integration Tests**: 80% ì´ìƒ
- **E2E Tests**: ì£¼ìš” ì‚¬ìš©ì í”Œë¡œìš° 100%

### ì»¤ë²„ë¦¬ì§€ í™•ì¸
```bash
# âœ… DO: ì •ê¸°ì ìœ¼ë¡œ ì»¤ë²„ë¦¬ì§€ í™•ì¸
npm run test:coverage
```

## ğŸš« TDD ì•ˆí‹°íŒ¨í„´

### 1. í…ŒìŠ¤íŠ¸ ì—†ì´ ì½”ë“œ ì‘ì„±
```typescript
// âŒ DON'T: êµ¬í˜„ë¶€í„° ì‹œì‘
export function calculateTotal(items: Item[]): number {
  return items.reduce((sum, item) => sum + item.price, 0);
}

// âœ… DO: í…ŒìŠ¤íŠ¸ë¶€í„° ì‹œì‘
describe('calculateTotal', () => {
  it('should return 0 for empty array', () => {
    expect(calculateTotal([])).toBe(0);
  });
});
```

### 2. í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í…ŒìŠ¤íŠ¸ ì‘ì„±
```typescript
// âŒ DON'T: ì˜ë¯¸ ì—†ëŠ” í…ŒìŠ¤íŠ¸
it('should have a method called getName', () => {
  expect(typeof user.getName).toBe('function');
});

// âœ… DO: ë™ì‘ì„ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸
it('should return user name when getName is called', () => {
  expect(user.getName()).toBe('John Doe');
});
```

### 3. ë³µì¡í•œ í…ŒìŠ¤íŠ¸ ì‘ì„±
```typescript
// âŒ DON'T: ì—¬ëŸ¬ ê¸°ëŠ¥ì„ í•œ ë²ˆì— í…ŒìŠ¤íŠ¸
it('should handle complete user workflow', () => {
  // ë„ˆë¬´ ë§ì€ ê²€ì¦...
});

// âœ… DO: ë‹¨ì¼ ê´€ì‹¬ì‚¬ í…ŒìŠ¤íŠ¸
it('should create user', () => {});
it('should validate user', () => {});
it('should save user', () => {});
```

## ğŸ“ TDD ì²´í¬ë¦¬ìŠ¤íŠ¸

### ìƒˆë¡œìš´ ê¸°ëŠ¥ ê°œë°œ ì‹œ:
- [ ] ìš”êµ¬ì‚¬í•­ì„ ì´í•´í•˜ê³  í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±
- [ ] ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì‘ì„± (Red)
- [ ] í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ëŠ” ìµœì†Œ ì½”ë“œ ì‘ì„± (Green)
- [ ] ì½”ë“œ í’ˆì§ˆ ê°œì„  (Refactor)
- [ ] ëª¨ë“  ê¸°ì¡´ í…ŒìŠ¤íŠ¸ê°€ ì—¬ì „íˆ í†µê³¼í•˜ëŠ”ì§€ í™•ì¸
- [ ] ì¶”ê°€ ì—£ì§€ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸ ì‘ì„±

### ë²„ê·¸ ìˆ˜ì • ì‹œ:
- [ ] ë²„ê·¸ë¥¼ ì¬í˜„í•˜ëŠ” ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ ì‘ì„±
- [ ] í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ë„ë¡ ë²„ê·¸ ìˆ˜ì •
- [ ] ê´€ë ¨ ê¸°ëŠ¥ì˜ íšŒê·€ í…ŒìŠ¤íŠ¸ í™•ì¸

## ğŸ› ï¸ ê¶Œì¥ ë„êµ¬

- **Test Runner**: Vitest
- **Assertion Library**: Vitest (built-in)
- **Mocking**: vi (Vitest)
- **React Testing**: @testing-library/react
- **E2E Testing**: Playwright
- **Coverage**: Vitest coverage

## ğŸ’¡ ì¶”ê°€ ê°€ì´ë“œë¼ì¸

### í…ŒìŠ¤íŠ¸ ê²©ë¦¬
```typescript
// âœ… DO: ê° í…ŒìŠ¤íŠ¸ëŠ” ë…ë¦½ì ì´ì–´ì•¼ í•¨
describe('UserService', () => {
  beforeEach(() => {
    // ê° í…ŒìŠ¤íŠ¸ ì „ì— ì´ˆê¸°í™”
    database.clear();
    vi.clearAllMocks();
  });
});
```

### í…ŒìŠ¤íŠ¸ ë°ì´í„° ê´€ë¦¬
```typescript
// âœ… DO: í…ŒìŠ¤íŠ¸ íŒ©í† ë¦¬ í•¨ìˆ˜ ì‚¬ìš©
function createTestUser(overrides = {}) {
  return {
    id: '1',
    email: 'test@example.com',
    name: 'Test User',
    ...overrides,
  };
}
```

ì´ TDD ê·œì¹™ì„ ë”°ë¥´ë©´ ë” ì•ˆì •ì ì´ê³  ìœ ì§€ë³´ìˆ˜ ê°€ëŠ¥í•œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.